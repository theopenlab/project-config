- job:
    name: base
    parent: null
    description: |
      The base job for OpenStack's installation of Zuul.
      
      All jobs ultimately inherit from this.  It runs a pre-playbook
      which copies all of the job's prepared git repos on to all of
      the nodes in the nodeset.  It runs a post-playbook which copies
      all of the files in the logs/ subdirectory of the executor
      work directory to the logserver.
      
      It also sets default timeout and nodeset values (which may be
      overidden).
    pre-run: playbooks/base/pre
    post-run:
      - playbooks/base/post-ssh
      - playbooks/base/post-logs
    roles:
      - zuul: theopenlab/zuul-jobs
#    vars:
#      ara_generate_html: failure
    timeout: 1800
#    secrets:
#      - site_logs
      
# See the procedure described above "base" before making changes to
# this job.
#- job:
#    name: base-test
#    parent: null
#    description: |
#      A job to test changes to the base job without disturbing the
#      main job in production.  Not for general use.
#    pre-run: playbooks/base-test/pre
#    post-run:
#      - playbooks/base-test/post-ssh
#      - playbooks/base-test/post-logs
#    roles:
#      - zuul: theopenlab/zuul-jobs
#    vars:
#      ara_generate_html: failure
#    timeout: 1800
#    secrets:
#      - site_logs

- semaphore:
    name: wheel-mirror
    max: 1
